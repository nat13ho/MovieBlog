@model PostListViewModel

@{
    Layout = "_AccountLayout";
    ViewData["Title"] = "Все новости";
}

<nav id="navbar">
    <a asp-controller="Home" asp-action="Index" class="navbar__logo">
        <img src="~/img/movieblog.png" alt="Navbar logo">
        <span>MovieBlog</span>
    </a>
    <div class="navbar__menu">
        <ul>
            <li>
                <a asp-controller="Home" asp-action="Index">Новости</a>
            </li>
            <li>
                <a>
                    Жанры
                    <svg class="navbar__menu-arrow" xmlns="http://www.w3.org/2000/svg"
                         width="451.847px" height="451.847px" viewBox="0 0 451.847 451.847"
                         xml:space="preserve">
                        <g>
                            <path d="M225.923,354.706c-8.098,0-16.195-3.092-22.369-9.263L9.27,151.157c-12.359-12.359-12.359-32.397,0-44.751
                                            c12.354-12.354,32.388-12.354,44.748,0l171.905,171.915l171.906-171.909c12.359-12.354,32.391-12.354,44.744,0
                                            c12.365,12.354,12.365,32.392,0,44.751L248.292,345.449C242.115,351.621,234.018,354.706,225.923,354.706z"/>
                        </g>
                    </svg>
                </a>
                <ul class="dropdown">
                    @foreach (var category in Model.Categories)
                    {
                        <li>
                            <a asp-controller="Home" asp-action="Index" asp-route-category="@category.Name">@category.Name</a>
                        </li>
                    }
                </ul>
            </li>
            @if (User.Identity.IsAuthenticated)
            {
                <li>
                    <a asp-controller="Account" asp-action="Profile">
                        Личный кабинет
                        <svg class="navbar__menu-arrow" xmlns="http://www.w3.org/2000/svg"
                             width="451.847px" height="451.847px" viewBox="0 0 451.847 451.847"
                             xml:space="preserve">
                            <g>
                                <path d="M225.923,354.706c-8.098,0-16.195-3.092-22.369-9.263L9.27,151.157c-12.359-12.359-12.359-32.397,0-44.751
                                                                c12.354-12.354,32.388-12.354,44.748,0l171.905,171.915l171.906-171.909c12.359-12.354,32.391-12.354,44.744,0
                                                                c12.365,12.354,12.365,32.392,0,44.751L248.292,345.449C242.115,351.621,234.018,354.706,225.923,354.706z"/>
                            </g>
                        </svg>
                    </a>
                    <ul class="dropdown">
                        <li>
                            <a asp-controller="Account" asp-action="Profile">Мой профиль</a>
                        </li>
                        <li>
                            <a asp-controller="Account" asp-action="Favorites">Избранные новости</a>
                        </li>
                        @if (User.Identity.IsAuthenticated)
                        {
                            @if (User.IsInRole("Admin"))
                            {
                                <li>
                                    <a asp-controller="Role" asp-action="GetUserList">Все пользователи</a>
                                </li>
                                <li>
                                    <a asp-controller="Role" asp-action="Index">Все роли</a>
                                </li>
                                <li>
                                    <a asp-controller="Post" asp-action="GetPostList">Все новости</a>
                                </li>
                                <li>
                                    <a asp-controller="Post" asp-action="AddCategory">Все жанры</a>
                                </li>
                            }
                        }
                    </ul>
                </li>
            }
        </ul>
    </div>
    <div class="navbar__buttons">
        @if (!User.Identity.IsAuthenticated)
        {
            <a asp-controller="Account" asp-action="Register" class="navbar__button register">Зарегистрироваться</a>
            <a asp-controller="Account" asp-action="Login" class="navbar__button login">Войти</a>
        }
        else
        {
            <form asp-controller="Account" asp-action="Logout" method="post">
                <button type="submit" class="navbar__button logout">Выйти</button>
            </form>
        }
    </div>
</nav>
<aside class="account__menu">
    <svg class="account__menu-icons" enable-background="new 0 0 512 512" height="512" viewBox="0 0 512 512" width="512" xmlns="http://www.w3.org/2000/svg"><g><g><g><path d="m416 230h-320c-19.299 0-35-15.701-35-35v-160c0-19.299 15.701-35 35-35h320c19.299 0 35 15.701 35 35v160c0 19.299-15.701 35-35 35z" fill="#aed0ff"/><g><path d="m416 0h-160v230h160c19.299 0 35-15.701 35-35v-160c0-19.299-15.701-35-35-35z" fill="#6aa9ff"/></g><path d="m96 30c-2.757 0-5 2.243-5 5v160c0 2.757 2.243 5 5 5h320c2.757 0 5-2.243 5-5v-160c0-2.757-2.243-5-5-5z" fill="#fff5f5"/><g><path d="m416 30h-160v170h160c2.757 0 5-2.243 5-5v-160c0-2.757-2.243-5-5-5z" fill="#e2dff4"/></g><g><path d="m216.001 170c-2.859 0-5.704-.817-8.175-2.422-4.258-2.767-6.826-7.5-6.826-12.578v-80c0-5.078 2.568-9.811 6.826-12.578 4.258-2.768 9.626-3.192 14.266-1.129l90 40c5.417 2.407 8.908 7.779 8.908 13.707s-3.491 11.3-8.908 13.707l-90 40c-1.947.866-4.023 1.293-6.091 1.293z" fill="#ff6326"/></g><g><path d="m312.092 101.293-56.092-24.93v77.273l56.092-24.93c5.417-2.406 8.908-7.778 8.908-13.706s-3.491-11.3-8.908-13.707z" fill="#ff1f3e"/></g></g></g><g><g><g><path d="m64.75 307v140h127.5v-140c0-16.569-13.431-30-30-30h-67.5c-16.569 0-30 13.431-30 30z" fill="#1766a0"/><path d="m192.25 307c0-16.569-13.431-30-30-30h-33.75v170h63.75z" fill="#08475e"/></g><g><path d="m192.25 307v140h127.5v-140c0-16.569-13.431-30-30-30h-67.5c-16.569 0-30 13.431-30 30z" fill="#1766a0"/><path d="m319.75 307c0-16.569-13.431-30-30-30h-33.75v170h63.75z" fill="#08475e"/></g><g><path d="m319.75 307v140h127.5v-140c0-16.569-13.431-30-30-30h-67.5c-16.569 0-30 13.431-30 30z" fill="#1766a0"/><path d="m447.25 307c0-16.569-13.431-30-30-30h-33.75v170h63.75z" fill="#08475e"/></g></g><g><g><path d="m1 387v110c0 8.284 6.716 15 15 15h112.5v-125c0-16.569-13.431-30-30-30h-67.5c-16.569 0-30 13.431-30 30z" fill="#1766a0"/><path d="m128.5 387c0-16.569-13.431-30-30-30h-33.75v155h63.75z" fill="#08475e"/></g><g><path d="m128.5 387v125h127.5v-125c0-16.569-13.431-30-30-30h-67.5c-16.569 0-30 13.431-30 30z" fill="#1766a0"/><path d="m256 387c0-16.569-13.431-30-30-30h-33.75v155h63.75z" fill="#08475e"/></g><g><path d="m256 387v125h127.5v-125c0-16.569-13.431-30-30-30h-67.5c-16.569 0-30 13.431-30 30z" fill="#1766a0"/><path d="m383.5 387c0-16.569-13.431-30-30-30h-33.75v155h63.75z" fill="#08475e"/></g><g><path d="m383.5 387v125h112.5c8.284 0 15-6.716 15-15v-110c0-16.569-13.431-30-30-30h-67.5c-16.569 0-30 13.431-30 30z" fill="#1766a0"/><path d="m511 387c0-16.569-13.431-30-30-30h-33.75v155h48.75c8.284 0 15-6.716 15-15z" fill="#08475e"/></g></g></g></g></svg>
    <h4>MovieBlog: Личный кабинет</h4>
    <hr>
    <div class="account__menu-links">
        <a asp-controller="Account" asp-action="Profile" class="profile">Мой профиль</a>
        <a asp-controller="Account" asp-action="Favorites" class="favorites">Избранные новости</a>
        @if (User.IsInRole("Admin"))
        {
            <div class="admin__links">
                <a asp-controller="Role" asp-action="GetUserList" class="users">Все пользователи</a>
                <a asp-controller="Role" asp-action="Index" class="roles">Все роли</a>
                <a asp-controller="Post" asp-action="GetPostList" class="posts">Все новости</a>
                <a asp-controller="Post" asp-action="AddCategory">Все жанры</a>
            </div>
        }
    </div>
</aside>
<section class="container account__control-wrapper">
        <div class="posts__control">
            <div class="posts__control-buttons">
                <a asp-controller="Post" asp-action="Create">Добавить новость</a>
                <a asp-controller="Post" asp-action="AddCategory">Добавить жанр</a>
            </div>
            <h1>Все новости</h1>
            <table class="posts__control-table">
                <thead>
                <tr>
                    <th>Новости</th>
                    <th>Дата публикации</th>
                    <th>Редактировать</th>
                    <th>Удалить</th>
                </tr>
                </thead>
                <tbody>
                @foreach (var post in Model.Posts)
                {
                    <tr>
                        <td class="posts__control-table-content">
                            <div class="posts__control-table-content-wrapper" style="background: url('@Url.Content(post.Image.Path)') no-repeat center top / cover">
                                <a asp-controller="Post" asp-action="Show" asp-route-id="@post.Id" class="news__item-details">Подробнее</a>
                                <div class="posts__control-details">
                                    <span>@post.Category.Name</span>
                                    <p>@post.Title</p>
                                </div>
                            </div>
                        </td>
                        <td><span class="post__date">@post.Created.ToString("MM/dd/yyyy HH:mm")</span></td>
                        <td><a asp-controller="Post" asp-action="Edit" asp-route-id="@post.Id">Редактировать</a></td>
                        <td>
                            <form asp-controller="Post" asp-action="Delete" asp-route-id="@post.Id" method="post" class="roles__control-form-delete">
                                <button type="submit">Удалить</button>
                            </form>
                        </td>
                    </tr>
                }
                </tbody>
            </table>
        </div>
</section>

